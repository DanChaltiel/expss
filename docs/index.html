<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="date" content="2019-07-06" />

<title>expss: Tables with Labels in R</title>

<script src="index_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="index_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="index_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<link href="index_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="index_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">expss: Tables with Labels in R</h1>
<h4 class="date">2019-07-06</h4>

</div>


<p><a href="https://cran.r-project.org/package=expss"><img src="http://www.r-pkg.org/badges/version/expss" alt="CRAN_Status_Badge" /></a> <a href="https://cran.rstudio.com/web/packages/expss/index.html"><img src="https://cranlogs.r-pkg.org/badges/expss" /></a> <a href="https://cran.rstudio.com/web/packages/expss/index.html"><img src="https://cranlogs.r-pkg.org/badges/grand-total/expss" /></a> <a href="https://codecov.io/github/gdemin/expss?branch=master"><img src="https://img.shields.io/codecov/c/github/gdemin/expss/master.svg" alt="Coverage Status" /></a></p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><code>expss</code> package provides tabulation functions with support for ‘SPSS’-style labels, multiple / nested banners, weights, multiple-response variables and significance testing. There are facilities for nice output of tables in ‘knitr’, R notebooks, ‘Shiny’ and ‘Jupyter’ notebooks. Proper methods for labelled variables add value labels support to base R functions and to some functions from other packages. Additionally, the package offers useful functions for data processing in marketing research / social surveys - popular data transformation functions from ‘SPSS’ Statistics (‘RECODE’, ‘COUNT’, ‘COMPUTE’, ‘DO IF’, etc.) and ‘Excel’ (‘COUNTIF’, ‘VLOOKUP’, etc.). Package is intended to help people to move data processing from ‘Excel’/‘SPSS’ to R. See examples below. You can get help about any function by typing <code>?function_name</code> in the R console.</p>
<div id="links" class="section level3">
<h3>Links</h3>
<ul>
<li><a href="http://gdemin.github.io/expss/">Online introduction (current page)</a></li>
<li><a href="https://cran.r-project.org/package=expss">expss on CRAN</a></li>
<li><a href="https://github.com/gdemin/expss">expss on Github</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/expss">expss on Stackoverflow</a></li>
<li><a href="https://github.com/gdemin/expss/issues">Issues</a></li>
</ul>
</div>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p><code>expss</code> is on CRAN, so for installation you can print in the console <code>install.packages(&quot;expss&quot;)</code>.</p>
</div>
<div id="cross-tablulation-examples" class="section level2">
<h2>Cross-tablulation examples</h2>
<p>We will use for demonstartion well-known <code>mtcars</code> dataset. Let’s start with adding labels to the dataset. Then we can continue with tables creation.</p>
<pre class="r"><code>library(expss)
data(mtcars)
mtcars = apply_labels(mtcars,
                      mpg = &quot;Miles/(US) gallon&quot;,
                      cyl = &quot;Number of cylinders&quot;,
                      disp = &quot;Displacement (cu.in.)&quot;,
                      hp = &quot;Gross horsepower&quot;,
                      drat = &quot;Rear axle ratio&quot;,
                      wt = &quot;Weight (1000 lbs)&quot;,
                      qsec = &quot;1/4 mile time&quot;,
                      vs = &quot;Engine&quot;,
                      vs = c(&quot;V-engine&quot; = 0,
                             &quot;Straight engine&quot; = 1),
                      am = &quot;Transmission&quot;,
                      am = c(&quot;Automatic&quot; = 0,
                             &quot;Manual&quot;=1),
                      gear = &quot;Number of forward gears&quot;,
                      carb = &quot;Number of carburetors&quot;
)</code></pre>
<p>For quick cross-tabulation there are <code>fre</code> and <code>cro</code> family of function. For simplicity we demonstrate here only <code>cro_cpct</code> which caluclates column percent. Documentation for other functions, such as <code>cro_cases</code> for counts, <code>cro_rpct</code> for row percent, <code>cro_tpct</code> for table percent and <code>cro_fun</code> for custom summary functions can be seen by typing <code>?cro</code> and <code>?cro_fun</code> in the console.</p>
<pre class="r"><code># &#39;cro&#39; examples
# just simple crosstabulation, similar to base R &#39;table&#39; function
cro(mtcars$am, mtcars$vs)</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Engine 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="3" style="font-weight: 900;">
 Transmission 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Automatic 
</td>
<td style="text-align: right;">
12
</td>
<td style="text-align: right;">
7
</td>
</tr>
<tr>
<td style="text-align: left;">
   Manual 
</td>
<td style="text-align: right;">
6
</td>
<td style="text-align: right;">
7
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
18
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
14
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Table column % with multiple banners
cro_cpct(mtcars$cyl, list(total(), mtcars$am, mtcars$vs))</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Engine 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="8" style="font-weight: 900;">
 Number of cylinders 
</td>
</tr>
<tr>
<td style="text-align: left;">
   4 
</td>
<td style="text-align: right;">
34.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
15.8
</td>
<td style="text-align: right;">
61.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.6
</td>
<td style="text-align: right;">
71.4
</td>
</tr>
<tr>
<td style="text-align: left;">
   6 
</td>
<td style="text-align: right;">
21.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.1
</td>
<td style="text-align: right;">
23.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7
</td>
<td style="text-align: right;">
28.6
</td>
</tr>
<tr>
<td style="text-align: left;">
   8 
</td>
<td style="text-align: right;">
43.8
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
63.2
</td>
<td style="text-align: right;">
15.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
77.8
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
32
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
19
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
13
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
18
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
14
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># or, the same result with another notation
mtcars %&gt;% calc_cro_cpct(cyl, list(total(), am, vs))</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Engine 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="8" style="font-weight: 900;">
 Number of cylinders 
</td>
</tr>
<tr>
<td style="text-align: left;">
   4 
</td>
<td style="text-align: right;">
34.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
15.8
</td>
<td style="text-align: right;">
61.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.6
</td>
<td style="text-align: right;">
71.4
</td>
</tr>
<tr>
<td style="text-align: left;">
   6 
</td>
<td style="text-align: right;">
21.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.1
</td>
<td style="text-align: right;">
23.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7
</td>
<td style="text-align: right;">
28.6
</td>
</tr>
<tr>
<td style="text-align: left;">
   8 
</td>
<td style="text-align: right;">
43.8
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
63.2
</td>
<td style="text-align: right;">
15.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
77.8
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
32
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
19
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
13
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
18
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
14
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Table with nested banners (column %).          
mtcars %&gt;% calc_cro_cpct(cyl, list(total(), am %nest% vs))     </code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="5" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="1" style="font-weight: 900; text-align: center;">
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="1" style="font-weight: 900; text-align: center;">
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Engine 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Engine 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="8" style="font-weight: 900;">
 Number of cylinders 
</td>
</tr>
<tr>
<td style="text-align: left;">
   4 
</td>
<td style="text-align: right;">
34.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
42.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7
</td>
<td style="text-align: right;">
100
</td>
</tr>
<tr>
<td style="text-align: left;">
   6 
</td>
<td style="text-align: right;">
21.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
57.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   8 
</td>
<td style="text-align: right;">
43.8
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
32
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
12
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
7
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
6
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
7
</td>
</tr>
</tbody>
</table>
<p>We have more sophisticated interface for table construction with <code>magrittr</code> piping. Table construction consists of at least of three functions chained with pipe operator: <code>%&gt;%</code>. At first we need to specify variables for which statistics will be computed with <code>tab_cells</code>. Secondary, we calculate statistics with one of the <code>tab_stat_*</code> functions. And last, we finalize table creation with <code>tab_pivot</code>, e. g.: <code>dataset %&gt;% tab_cells(variable) %&gt;% tab_stat_cases() %&gt;% tab_pivot()</code>. After that we can optionally sort table with <code>tab_sort_asc</code>, drop empty rows/columns with <code>drop_rc</code> and transpose with <code>tab_transpose</code>. Resulting table is just a <code>data.frame</code> so we can use usual R operations on it. Detailed documentation for table creation can be seen via <code>?tables</code>. For significance testing see <code>?significance</code>. Generally, tables automatically translated to HTML for output in knitr or Jupyter notebooks. However, if we want HTML output in the R notebooks or in the RStudio viewer we need to set options for that: <code>expss_output_rnotebook()</code> or <code>expss_output_viewer()</code>.</p>
<pre class="r"><code># simple example
mtcars %&gt;% 
    tab_cells(cyl) %&gt;% 
    tab_cols(total(), am) %&gt;% 
    tab_stat_cpct() %&gt;% 
    tab_pivot()</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="5" style="font-weight: 900;">
 Number of cylinders 
</td>
</tr>
<tr>
<td style="text-align: left;">
   4 
</td>
<td style="text-align: right;">
34.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
15.8
</td>
<td style="text-align: right;">
61.5
</td>
</tr>
<tr>
<td style="text-align: left;">
   6 
</td>
<td style="text-align: right;">
21.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.1
</td>
<td style="text-align: right;">
23.1
</td>
</tr>
<tr>
<td style="text-align: left;">
   8 
</td>
<td style="text-align: right;">
43.8
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
63.2
</td>
<td style="text-align: right;">
15.4
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
32
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
19
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
13
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># table with caption
mtcars %&gt;% 
    tab_cells(mpg, disp, hp, wt, qsec) %&gt;%
    tab_cols(total(), am) %&gt;% 
    tab_stat_mean_sd_n() %&gt;%
    tab_last_sig_means(subtable_marks = &quot;both&quot;) %&gt;% 
    tab_pivot() %&gt;% 
    set_caption(&quot;Table with summary statistics and significance marks.&quot;)</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="6" style="text-align: left;">
Table with summary statistics and significance marks.
</td>
</tr>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="1" style="font-weight: 900; text-align: center;">
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 A 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 B 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="6" style="font-weight: 900;">
 Miles/(US) gallon 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Mean 
</td>
<td style="text-align: right;">
20.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
17.1 &lt; B
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
24.4 &gt; A
</td>
</tr>
<tr>
<td style="text-align: left;">
   Std. dev. 
</td>
<td style="text-align: right;">
6.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
3.8  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
6.2  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Unw. valid N 
</td>
<td style="text-align: right;">
32.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
19.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.0  
</td>
</tr>
<tr>
<td colspan="6" style="font-weight: 900;">
 Displacement (cu.in.) 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Mean 
</td>
<td style="text-align: right;">
230.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
290.4 &gt; B
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
143.5 &lt; A
</td>
</tr>
<tr>
<td style="text-align: left;">
   Std. dev. 
</td>
<td style="text-align: right;">
123.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
110.2  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
87.2  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Unw. valid N 
</td>
<td style="text-align: right;">
32.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
19.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.0  
</td>
</tr>
<tr>
<td colspan="6" style="font-weight: 900;">
 Gross horsepower 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Mean 
</td>
<td style="text-align: right;">
146.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
160.3  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
126.8  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Std. dev. 
</td>
<td style="text-align: right;">
68.6 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
53.9  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
84.1  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Unw. valid N 
</td>
<td style="text-align: right;">
32.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
19.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.0  
</td>
</tr>
<tr>
<td colspan="6" style="font-weight: 900;">
 Weight (1000 lbs) 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Mean 
</td>
<td style="text-align: right;">
3.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
3.8 &gt; B
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.4 &lt; A
</td>
</tr>
<tr>
<td style="text-align: left;">
   Std. dev. 
</td>
<td style="text-align: right;">
1.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
0.8  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
0.6  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Unw. valid N 
</td>
<td style="text-align: right;">
32.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
19.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.0  
</td>
</tr>
<tr>
<td colspan="6" style="font-weight: 900;">
 1/4 mile time 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Mean 
</td>
<td style="text-align: right;">
17.8 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
18.2  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
17.4  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Std. dev. 
</td>
<td style="text-align: right;">
1.8 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.8  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.8  
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   Unw. valid N 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
32.0 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
19.0  
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
13.0  
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Table with the same summary statistics. Statistics labels in columns.
mtcars %&gt;% 
    tab_cells(mpg, disp, hp, wt, qsec) %&gt;%
    tab_cols(total(label = &quot;#Total| |&quot;), am) %&gt;% 
    tab_stat_fun(Mean = w_mean, &quot;Std. dev.&quot; = w_sd, &quot;Valid N&quot; = w_n, method = list) %&gt;%
    tab_pivot()</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="7" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
   
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Mean 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Std. dev. 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Valid N 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Mean 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Std. dev. 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Valid N 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Mean 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Std. dev. 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Valid N 
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
 Miles/(US) gallon 
</td>
<td style="text-align: right;">
20.1
</td>
<td style="text-align: right;">
6.0
</td>
<td style="text-align: right;">
32
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
17.1
</td>
<td style="text-align: right;">
3.8
</td>
<td style="text-align: right;">
19
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
24.4
</td>
<td style="text-align: right;">
6.2
</td>
<td style="text-align: right;">
13
</td>
</tr>
<tr>
<td style="text-align: left;">
 Displacement (cu.in.) 
</td>
<td style="text-align: right;">
230.7
</td>
<td style="text-align: right;">
123.9
</td>
<td style="text-align: right;">
32
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
290.4
</td>
<td style="text-align: right;">
110.2
</td>
<td style="text-align: right;">
19
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
143.5
</td>
<td style="text-align: right;">
87.2
</td>
<td style="text-align: right;">
13
</td>
</tr>
<tr>
<td style="text-align: left;">
 Gross horsepower 
</td>
<td style="text-align: right;">
146.7
</td>
<td style="text-align: right;">
68.6
</td>
<td style="text-align: right;">
32
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
160.3
</td>
<td style="text-align: right;">
53.9
</td>
<td style="text-align: right;">
19
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
126.8
</td>
<td style="text-align: right;">
84.1
</td>
<td style="text-align: right;">
13
</td>
</tr>
<tr>
<td style="text-align: left;">
 Weight (1000 lbs) 
</td>
<td style="text-align: right;">
3.2
</td>
<td style="text-align: right;">
1.0
</td>
<td style="text-align: right;">
32
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
3.8
</td>
<td style="text-align: right;">
0.8
</td>
<td style="text-align: right;">
19
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.4
</td>
<td style="text-align: right;">
0.6
</td>
<td style="text-align: right;">
13
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
 1/4 mile time 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
17.8
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1.8
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
32
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
18.2
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1.8
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
19
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
17.4
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1.8
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
13
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Different statistics for different variables.
mtcars %&gt;%
    tab_cols(total(), vs) %&gt;%
    tab_cells(mpg) %&gt;% 
    tab_stat_mean() %&gt;% 
    tab_stat_valid_n() %&gt;% 
    tab_cells(am) %&gt;%
    tab_stat_cpct(total_row_position = &quot;none&quot;, label = &quot;col %&quot;) %&gt;%
    tab_stat_rpct(total_row_position = &quot;none&quot;, label = &quot;row %&quot;) %&gt;%
    tab_stat_tpct(total_row_position = &quot;none&quot;, label = &quot;table %&quot;) %&gt;%
    tab_pivot(stat_position = &quot;inside_rows&quot;) </code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-top: 2px solid grey; text-align: center;">
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Engine 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="7" style="font-weight: 900;">
 Miles/(US) gallon 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Mean 
</td>
<td style="text-align: left;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
20.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.6
</td>
<td style="text-align: right;">
24.6
</td>
</tr>
<tr>
<td style="text-align: left;">
   Valid N 
</td>
<td style="text-align: left;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
32.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
18.0
</td>
<td style="text-align: right;">
14.0
</td>
</tr>
<tr>
<td colspan="7" style="font-weight: 900;">
 Transmission 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Automatic 
</td>
<td style="text-align: left;">
 col % 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
59.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
66.7
</td>
<td style="text-align: right;">
50.0
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
 row % 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
63.2
</td>
<td style="text-align: right;">
36.8
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
 table % 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
59.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
37.5
</td>
<td style="text-align: right;">
21.9
</td>
</tr>
<tr>
<td style="text-align: left;">
   Manual 
</td>
<td style="text-align: left;">
 col % 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
40.6
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3
</td>
<td style="text-align: right;">
50.0
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
 row % 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
46.2
</td>
<td style="text-align: right;">
53.8
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
  
</td>
<td style="border-bottom: 2px solid grey; text-align: left;">
 table % 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
40.6
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
18.8
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
21.9
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Table with split by rows and with custom totals.
mtcars %&gt;% 
    tab_cells(cyl) %&gt;% 
    tab_cols(total(), vs) %&gt;% 
    tab_rows(am) %&gt;% 
    tab_stat_cpct(total_row_position = &quot;above&quot;,
                  total_label = c(&quot;number of cases&quot;, &quot;row %&quot;),
                  total_statistic = c(&quot;u_cases&quot;, &quot;u_rpct&quot;)) %&gt;% 
    tab_pivot()</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="2" style="font-weight: 900; border-top: 2px solid grey; text-align: center;">
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Engine 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="8" style="font-weight: 900;">
 Transmission 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Automatic 
</td>
<td style="text-align: left;">
 Number of cylinders 
</td>
<td style="text-align: left;">
 #number of cases 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
19
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
12
</td>
<td style="text-align: right;">
7
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
</td>
<td style="text-align: left;">
 #row % 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
63.2
</td>
<td style="text-align: right;">
36.8
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
</td>
<td style="text-align: left;">
 4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
15.8
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
42.9
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
</td>
<td style="text-align: left;">
 6 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
57.1
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
</td>
<td style="text-align: left;">
 8 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
63.2
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100.0
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Manual 
</td>
<td style="text-align: left;">
 Number of cylinders 
</td>
<td style="text-align: left;">
 #number of cases 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
6
</td>
<td style="text-align: right;">
7
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
</td>
<td style="text-align: left;">
 #row % 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
46.2
</td>
<td style="text-align: right;">
53.8
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
</td>
<td style="text-align: left;">
 4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
61.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7
</td>
<td style="text-align: right;">
100.0
</td>
</tr>
<tr>
<td style="text-align: left;">
  
</td>
<td style="text-align: left;">
</td>
<td style="text-align: left;">
 6 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
23.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
  
</td>
<td style="border-bottom: 2px solid grey; text-align: left;">
</td>
<td style="border-bottom: 2px solid grey; text-align: left;">
 8 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
15.4
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
33.3
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Linear regression by groups.
mtcars %&gt;% 
    tab_cells(sheet(mpg, disp, hp, wt, qsec)) %&gt;% 
    tab_cols(total(label = &quot;#Total| |&quot;), am) %&gt;% 
    tab_stat_fun_df(
        function(x){
            frm = reformulate(&quot;.&quot;, response = as.name(names(x)[1]))
            model = lm(frm, data = x)
            sheet(&#39;Coef.&#39; = coef(model), 
                  confint(model)
            )
        }   
    ) %&gt;% 
    tab_pivot() </code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="7" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
   
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Coef. 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 2.5 % 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 97.5 % 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Coef. 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 2.5 % 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 97.5 % 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Coef. 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 2.5 % 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 97.5 % 
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
 (Intercept) 
</td>
<td style="text-align: right;">
27.3
</td>
<td style="text-align: right;">
9.6
</td>
<td style="text-align: right;">
45.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.8
</td>
<td style="text-align: right;">
-1.9
</td>
<td style="text-align: right;">
45.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.3
</td>
<td style="text-align: right;">
-21.9
</td>
<td style="text-align: right;">
48.4
</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>Displacement (cu.in.)</code> 
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
0.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
0.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
-0.1
</td>
<td style="text-align: right;">
0.1
</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>Gross horsepower</code> 
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
-0.1
</td>
<td style="text-align: right;">
0.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
-0.1
</td>
<td style="text-align: right;">
0.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
0.0
</td>
<td style="text-align: right;">
0.1
</td>
</tr>
<tr>
<td style="text-align: left;">
 <code>Weight (1000 lbs)</code> 
</td>
<td style="text-align: right;">
-4.6
</td>
<td style="text-align: right;">
-7.2
</td>
<td style="text-align: right;">
-2.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
-2.3
</td>
<td style="text-align: right;">
-5.0
</td>
<td style="text-align: right;">
0.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
-7.7
</td>
<td style="text-align: right;">
-12.5
</td>
<td style="text-align: right;">
-2.9
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
 <code>1/4 mile time</code> 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
0.5
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
-0.4
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1.5
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
0.4
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
-0.7
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1.6
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1.6
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
-0.2
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
3.4
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-of-data-processing-with-multiple-response-variables" class="section level2">
<h2>Example of data processing with multiple-response variables</h2>
<p>Here we use truncated dataset with data from product test of two samples of chocolate sweets. 150 respondents tested two kinds of sweets (codenames: VSX123 and SDF546). Sample was divided into two groups (cells) of 75 respondents in each group. In cell 1 product VSX123 was presented first and then SDF546. In cell 2 sweets were presented in reversed order. Questions about respondent impressions about first product are in the block A (and about second tested product in the block B). At the end of the questionnaire there was a question about the preferences between sweets.</p>
<p>List of variables:</p>
<ul>
<li><code>id</code> Respondent Id</li>
<li><code>cell</code> First tested product (cell number)</li>
<li><code>s2a</code> Age</li>
<li><code>a1_1-a1_6</code> What did you like in these sweets? Multiple response. First tested product</li>
<li><code>a22</code> Overall quality. First tested product</li>
<li><code>b1_1-b1_6</code> What did you like in these sweets? Multiple response. Second tested product</li>
<li><code>b22</code> Overall quality. Second tested product</li>
<li><code>c1</code> Preferences</li>
</ul>
<pre class="r"><code>data(product_test)

w = product_test # shorter name to save some keystrokes

# here we recode variables from first/second tested product to separate variables for each product according to their cells
# &#39;h&#39; variables - VSX123 sample, &#39;p&#39; variables - &#39;SDF456&#39; sample
# also we recode preferences from first/second product to true names
# for first cell there are no changes, for second cell we should exchange 1 and 2.
w = w %&gt;% 
    do_if(cell == 1, {
        recode(a1_1 %to% a1_6, other ~ copy) %into% (h1_1 %to% h1_6)
        recode(b1_1 %to% b1_6, other ~ copy) %into% (p1_1 %to% p1_6)
        recode(a22, other ~ copy) %into% h22
        recode(b22, other ~ copy) %into% p22
        c1r = c1
    }) %&gt;% 
    do_if(cell == 2, {
        recode(a1_1 %to% a1_6, other ~ copy) %into% (p1_1 %to% p1_6)
        recode(b1_1 %to% b1_6, other ~ copy) %into% (h1_1 %to% h1_6)
        recode(a22, other ~ copy) %into% p22
        recode(b22, other ~ copy) %into% h22
        recode(c1, 1 ~ 2, 2 ~ 1, other ~ copy) %into% c1r
    }) %&gt;% 
    compute({
        # recode age by groups
        age_cat = recode(s2a, lo %thru% 25 ~ 1, lo %thru% hi ~ 2)
        # count number of likes
        # codes 2 and 99 are ignored.
        h_likes = count_row_if(1 | 3 %thru% 98, h1_1 %to% h1_6) 
        p_likes = count_row_if(1 | 3 %thru% 98, p1_1 %to% p1_6) 
    })

# here we prepare labels for future usage
codeframe_likes = num_lab(&quot;
    1 Liked everything
    2 Disliked everything
    3 Chocolate
    4 Appearance
    5 Taste
    6 Stuffing
    7 Nuts
    8 Consistency
    98 Other
    99 Hard to answer
&quot;)

overall_liking_scale = num_lab(&quot;
    1 Extremely poor 
    2 Very poor
    3 Quite poor
    4 Neither good, nor poor
    5 Quite good
    6 Very good
    7 Excellent
&quot;)

w = apply_labels(w, 
    c1r = &quot;Preferences&quot;,
    c1r = num_lab(&quot;
        1 VSX123 
        2 SDF456
        3 Hard to say
    &quot;),
    
    age_cat = &quot;Age&quot;,
    age_cat = c(&quot;18 - 25&quot; = 1, &quot;26 - 35&quot; = 2),
    
    h1_1 = &quot;Likes. VSX123&quot;,
    p1_1 = &quot;Likes. SDF456&quot;,
    h1_1 = codeframe_likes,
    p1_1 = codeframe_likes,
    
    h_likes = &quot;Number of likes. VSX123&quot;,
    p_likes = &quot;Number of likes. SDF456&quot;,
    
    h22 = &quot;Overall quality. VSX123&quot;,
    p22 = &quot;Overall quality. SDF456&quot;,
    h22 = overall_liking_scale,
    p22 = overall_liking_scale
)</code></pre>
<p>Are there any significant differences between preferences? Yes, difference is significant.</p>
<pre class="r"><code># &#39;tab_mis_val(3)&#39; remove &#39;hard to say&#39; from vector 
w %&gt;% tab_cols(total(), age_cat) %&gt;% 
      tab_cells(c1r) %&gt;% 
      tab_mis_val(3) %&gt;% 
      tab_stat_cases() %&gt;% 
      tab_last_sig_cases() %&gt;% 
      tab_pivot()</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Age 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 18 - 25 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 26 - 35 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="5" style="font-weight: 900;">
 Preferences 
</td>
</tr>
<tr>
<td style="text-align: left;">
   VSX123 
</td>
<td style="text-align: right;">
94.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
46.0 
</td>
<td style="text-align: right;">
48.0 
</td>
</tr>
<tr>
<td style="text-align: left;">
   SDF456 
</td>
<td style="text-align: right;">
50.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
22.0 
</td>
<td style="text-align: right;">
28.0 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Hard to say 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   #Chi-squared p-value 
</td>
<td style="text-align: right;">
&lt;0.05 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
(warn.)
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
144.0 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
68.0 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
76.0 
</td>
</tr>
</tbody>
</table>
<p>Further we calculate distribution of answers in the survey questions.</p>
<pre class="r"><code># lets specify repeated parts of table creation chains
banner = w %&gt;% tab_cols(total(), age_cat, c1r) 
# column percent with significance
tab_cpct_sig = . %&gt;% tab_stat_cpct() %&gt;% 
                    tab_last_sig_cpct(sig_labels = paste0(&quot;&lt;b&gt;&quot;,LETTERS, &quot;&lt;/b&gt;&quot;))

# means with siginifcance
tab_means_sig = . %&gt;% tab_stat_mean_sd_n(labels = c(&quot;&lt;b&gt;&lt;u&gt;Mean&lt;/u&gt;&lt;/b&gt;&quot;, &quot;sd&quot;, &quot;N&quot;)) %&gt;% 
                      tab_last_sig_means(
                          sig_labels = paste0(&quot;&lt;b&gt;&quot;,LETTERS, &quot;&lt;/b&gt;&quot;),   
                          keep = &quot;means&quot;)

# Preferences
banner %&gt;% 
    tab_cells(c1r) %&gt;% 
    tab_cpct_sig() %&gt;% 
    tab_pivot() </code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Age 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="5" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Preferences 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="1" style="font-weight: 900; text-align: center;">
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 18 - 25 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 26 - 35 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 VSX123 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 SDF456 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Hard to say 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>A</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>B</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>A</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>B</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>C</b> 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="12" style="font-weight: 900;">
 Preferences 
</td>
</tr>
<tr>
<td style="text-align: left;">
   VSX123 
</td>
<td style="text-align: right;">
62.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
65.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
60.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   SDF456 
</td>
<td style="text-align: right;">
33.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
31.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Hard to say 
</td>
<td style="text-align: right;">
4.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
100.0 
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
150 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
70 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
80 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
94 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
50 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
6 
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Overall liking
banner %&gt;%  
    tab_cells(h22) %&gt;% 
    tab_means_sig() %&gt;% 
    tab_cpct_sig() %&gt;%  
    tab_cells(p22) %&gt;% 
    tab_means_sig() %&gt;% 
    tab_cpct_sig() %&gt;%
    tab_pivot() </code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Age 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="5" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Preferences 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="1" style="font-weight: 900; text-align: center;">
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 18 - 25 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 26 - 35 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 VSX123 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 SDF456 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Hard to say 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>A</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>B</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>A</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>B</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>C</b> 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="12" style="font-weight: 900;">
 Overall quality. VSX123 
</td>
</tr>
<tr>
<td style="text-align: left;">
   <b><u>Mean</u></b> 
</td>
<td style="text-align: right;">
5.5 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.6 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.8 <b>A</b>
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.5 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Extremely poor 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Very poor 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Quite poor 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.2  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
3.2  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Neither good, nor poor 
</td>
<td style="text-align: right;">
10.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
11.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
10.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
14.9 <b>B</b>
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Quite good 
</td>
<td style="text-align: right;">
39.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
45.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.8  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
40.4  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
38.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Very good 
</td>
<td style="text-align: right;">
33.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
24.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
41.2 <b>A</b>
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
30.9  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
38.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Excellent 
</td>
<td style="text-align: right;">
14.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
15.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.8  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
10.6  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
22.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   #Total cases 
</td>
<td style="text-align: right;">
150 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
70 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
80  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
94  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
6 
</td>
</tr>
<tr>
<td colspan="12" style="font-weight: 900;">
 Overall quality. SDF456 
</td>
</tr>
<tr>
<td style="text-align: left;">
   <b><u>Mean</u></b> 
</td>
<td style="text-align: right;">
5.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Extremely poor 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Very poor 
</td>
<td style="text-align: right;">
0.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Quite poor 
</td>
<td style="text-align: right;">
2.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
4.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
4.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Neither good, nor poor 
</td>
<td style="text-align: right;">
16.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
20.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.8 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
18.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
14.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Quite good 
</td>
<td style="text-align: right;">
31.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
27.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
28.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
38.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Very good 
</td>
<td style="text-align: right;">
35.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
34.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Excellent 
</td>
<td style="text-align: right;">
13.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
12.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.8 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
14.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
10.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
150 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
70 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
80 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
94 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
50 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
6 
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Likes
banner %&gt;% 
    tab_cells(h_likes) %&gt;% 
    tab_means_sig() %&gt;% 
    tab_cells(mrset(h1_1 %to% h1_6)) %&gt;% 
    tab_cpct_sig() %&gt;% 
    tab_cells(p_likes) %&gt;% 
    tab_means_sig() %&gt;% 
    tab_cells(mrset(p1_1 %to% p1_6)) %&gt;% 
    tab_cpct_sig() %&gt;%
    tab_pivot() </code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Age 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="5" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Preferences 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="1" style="font-weight: 900; text-align: center;">
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 18 - 25 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 26 - 35 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 VSX123 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 SDF456 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Hard to say 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>A</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>B</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>A</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>B</b> 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 <b>C</b> 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="12" style="font-weight: 900;">
 Number of likes. VSX123 
</td>
</tr>
<tr>
<td style="text-align: left;">
   <b><u>Mean</u></b> 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.3 
</td>
</tr>
<tr>
<td colspan="12" style="font-weight: 900;">
 Likes. VSX123 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Liked everything 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Disliked everything 
</td>
<td style="text-align: right;">
3.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
4.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Chocolate 
</td>
<td style="text-align: right;">
34.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
38.6 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
30.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
32.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Appearance 
</td>
<td style="text-align: right;">
29.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
36.2 <b>A</b>
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
25.5 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
38.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Taste 
</td>
<td style="text-align: right;">
32.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
38.6 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
26.2  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
23.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
48.0 <b>A</b>
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Stuffing 
</td>
<td style="text-align: right;">
27.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
20.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.8  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
28.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
26.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Nuts 
</td>
<td style="text-align: right;">
66.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
72.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
61.3  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
69.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
60.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
83.3  
</td>
</tr>
<tr>
<td style="text-align: left;">
   Consistency 
</td>
<td style="text-align: right;">
12.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
4.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
18.8 <b>A</b>
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
8.5 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
14.0  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0 <b>A</b> <b>B</b>
</td>
</tr>
<tr>
<td style="text-align: left;">
   Other 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Hard to answer 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   #Total cases 
</td>
<td style="text-align: right;">
150 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
70 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
80  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
94 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50  
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
6  
</td>
</tr>
<tr>
<td colspan="12" style="font-weight: 900;">
 Number of likes. SDF456 
</td>
</tr>
<tr>
<td style="text-align: left;">
   <b><u>Mean</u></b> 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.0 
</td>
</tr>
<tr>
<td colspan="12" style="font-weight: 900;">
 Likes. SDF456 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Liked everything 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Disliked everything 
</td>
<td style="text-align: right;">
1.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.4 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Chocolate 
</td>
<td style="text-align: right;">
32.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
27.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
36.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
29.8 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
34.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Appearance 
</td>
<td style="text-align: right;">
32.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
28.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
34.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
30.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Taste 
</td>
<td style="text-align: right;">
39.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
42.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
36.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
36.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
44.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Stuffing 
</td>
<td style="text-align: right;">
27.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
24.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
30.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
31.9 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
20.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Nuts 
</td>
<td style="text-align: right;">
61.3 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
60.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
62.5 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
58.5 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
68.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Consistency 
</td>
<td style="text-align: right;">
10.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
13.8 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
11.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
6.0 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7 
</td>
</tr>
<tr>
<td style="text-align: left;">
   Other 
</td>
<td style="text-align: right;">
0.7 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.2 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
1.1 
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   Hard to answer 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
150 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
70 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
80 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
94 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
50 
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
6 
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># below more complicated table where we compare likes side by side
# Likes - side by side comparison
w %&gt;% 
    tab_cols(total(label = &quot;#Total| |&quot;), c1r) %&gt;% 
    tab_cells(list(unvr(mrset(h1_1 %to% h1_6)))) %&gt;% 
    tab_stat_cpct(label = var_lab(h1_1)) %&gt;% 
    tab_cells(list(unvr(mrset(p1_1 %to% p1_6)))) %&gt;% 
    tab_stat_cpct(label = var_lab(p1_1)) %&gt;% 
    tab_pivot(stat_position = &quot;inside_columns&quot;) </code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="8" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Preferences 
</th>
</tr>
<tr>
<th style>
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
   
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 VSX123 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 SDF456 
</th>
<th style="; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
 Hard to say 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. VSX123 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. SDF456 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. VSX123 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. SDF456 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. VSX123 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. SDF456 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. VSX123 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Likes. SDF456 
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
 Liked everything 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
 Disliked everything 
</td>
<td style="text-align: right;">
3.3
</td>
<td style="text-align: right;">
1.3
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
4.3
</td>
<td style="text-align: right;">
2.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
2
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
 Chocolate 
</td>
<td style="text-align: right;">
34.0
</td>
<td style="text-align: right;">
32.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
35.1
</td>
<td style="text-align: right;">
29.8
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
32
</td>
<td style="text-align: right;">
34
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3
</td>
<td style="text-align: right;">
50.0
</td>
</tr>
<tr>
<td style="text-align: left;">
 Appearance 
</td>
<td style="text-align: right;">
29.3
</td>
<td style="text-align: right;">
32.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
25.5
</td>
<td style="text-align: right;">
34.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
38
</td>
<td style="text-align: right;">
30
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7
</td>
<td style="text-align: right;">
16.7
</td>
</tr>
<tr>
<td style="text-align: left;">
 Taste 
</td>
<td style="text-align: right;">
32.0
</td>
<td style="text-align: right;">
39.3
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
23.4
</td>
<td style="text-align: right;">
36.2
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
48
</td>
<td style="text-align: right;">
44
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
33.3
</td>
<td style="text-align: right;">
50.0
</td>
</tr>
<tr>
<td style="text-align: left;">
 Stuffing 
</td>
<td style="text-align: right;">
27.3
</td>
<td style="text-align: right;">
27.3
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
28.7
</td>
<td style="text-align: right;">
31.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
26
</td>
<td style="text-align: right;">
20
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7
</td>
<td style="text-align: right;">
16.7
</td>
</tr>
<tr>
<td style="text-align: left;">
 Nuts 
</td>
<td style="text-align: right;">
66.7
</td>
<td style="text-align: right;">
61.3
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
69.1
</td>
<td style="text-align: right;">
58.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
60
</td>
<td style="text-align: right;">
68
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
83.3
</td>
<td style="text-align: right;">
50.0
</td>
</tr>
<tr>
<td style="text-align: left;">
 Consistency 
</td>
<td style="text-align: right;">
12.0
</td>
<td style="text-align: right;">
10.0
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
8.5
</td>
<td style="text-align: right;">
11.7
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
14
</td>
<td style="text-align: right;">
6
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
50.0
</td>
<td style="text-align: right;">
16.7
</td>
</tr>
<tr>
<td style="text-align: left;">
 Other 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
0.7
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
1.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
 Hard to answer 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
 #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
150
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
150
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
94
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
94
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
50
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
50
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
6
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
6
</td>
</tr>
</tbody>
</table>
<p>We can save labelled dataset as *.csv file with accompanying R code for labelling.</p>
<pre class="r"><code>write_labelled_csv(w, file  filename = &quot;product_test.csv&quot;)</code></pre>
<p>Or, we can save dataset as *.csv file with SPSS syntax to read data and apply labels.</p>
<pre class="r"><code>write_labelled_spss(w, file  filename = &quot;product_test.csv&quot;)</code></pre>
</div>
<div id="labels-support-for-base-r" class="section level2">
<h2>Labels support for base R</h2>
<p>Variable label is human readable description of the variable. R supports rather long variable names and these names can contain even spaces and punctuation but short variables names make coding easier. Variable label can give a nice, long description of variable. With this description it is easier to remember what those variable names refer to. Value labels are similar to variable labels, but value labels are descriptions of the values a variable can take. Labeling values means we don’t have to remember if 1=Extremely poor and 7=Excellent or vice-versa. We can easily get dataset description and variables summary with <code>info</code> function.</p>
<p>The usual way to connect numeric data to labels in R is factor variables. However, factors miss important features which the value labels provide. Factors only allow for integers to be mapped to a text label, these integers have to be a count starting at 1 and every value need to be labelled. Also, we can’t calculate means or other numeric statistics on factors.</p>
<p>With labels we can manipulate short variable names and codes when we analyze our data but in the resulting tables and graphs we will see human-readable text.</p>
<p>It is easy to store labels as variable attributes in R but most R functions cannot use them or even drop them. <code>expss</code> package integrates value labels support into base R functions and into functions from other packages. Every function which internally converts variable to factor will utilize labels. Labels will be preserved during variables subsetting and concatenation. Additionally, there is a function (<code>use_labels</code>) which greatly simplify variable labels usage. See examples below.</p>
<div id="getting-and-setting-variable-and-value-labels" class="section level3">
<h3>Getting and setting variable and value labels</h3>
<p>First, apply value and variables labels to dataset:</p>
<pre class="r"><code>library(expss)
data(mtcars)
mtcars = apply_labels(mtcars,
                      mpg = &quot;Miles/(US) gallon&quot;,
                      cyl = &quot;Number of cylinders&quot;,
                      disp = &quot;Displacement (cu.in.)&quot;,
                      hp = &quot;Gross horsepower&quot;,
                      drat = &quot;Rear axle ratio&quot;,
                      wt = &quot;Weight (1000 lbs)&quot;,
                      qsec = &quot;1/4 mile time&quot;,
                      vs = &quot;Engine&quot;,
                      vs = c(&quot;V-engine&quot; = 0,
                             &quot;Straight engine&quot; = 1),
                      am = &quot;Transmission&quot;,
                      am = c(&quot;Automatic&quot; = 0,
                             &quot;Manual&quot;=1),
                      gear = &quot;Number of forward gears&quot;,
                      carb = &quot;Number of carburetors&quot;
)</code></pre>
<p>In addition to <code>apply_labels</code> we have SPSS-style <code>var_lab</code> and <code>val_lab</code> functions:</p>
<pre class="r"><code>nps = c(-1, 0, 1, 1, 0, 1, 1, -1)
var_lab(nps) = &quot;Net promoter score&quot;
val_lab(nps) = num_lab(&quot;
            -1 Detractors
             0 Neutralists    
             1 Promoters    
&quot;)</code></pre>
<p>We can read, add or remove existing labels:</p>
<pre class="r"><code>var_lab(nps) # get variable label</code></pre>
<pre><code>## [1] &quot;Net promoter score&quot;</code></pre>
<pre class="r"><code>val_lab(nps) # get value labels</code></pre>
<pre><code>##  Detractors Neutralists   Promoters 
##          -1           0           1</code></pre>
<pre class="r"><code># add new labels
add_val_lab(nps) = num_lab(&quot;
                           98 Other    
                           99 Hard to say
                           &quot;)

# remove label by value
# %d% - diff, %n_d% - names diff 
val_lab(nps) = val_lab(nps) %d% 98
# or, remove value by name
val_lab(nps) = val_lab(nps) %n_d% &quot;Other&quot;</code></pre>
<p>Additionaly, there are some utility functions. They can applied on one variable as well as on the entire dataset.</p>
<pre class="r"><code>drop_val_labs(nps)</code></pre>
<pre><code>## LABEL: Net promoter score 
## VALUES:
## -1, 0, 1, 1, 0, 1, 1, -1</code></pre>
<pre class="r"><code>drop_var_labs(nps)</code></pre>
<pre><code>## VALUES:
## -1, 0, 1, 1, 0, 1, 1, -1
## VALUE LABELS:               
##  -1 Detractors 
##   0 Neutralists
##   1 Promoters  
##  99 Hard to say</code></pre>
<pre class="r"><code>unlab(nps)</code></pre>
<pre><code>## [1] -1  0  1  1  0  1  1 -1</code></pre>
<pre class="r"><code>drop_unused_labels(nps)</code></pre>
<pre><code>## LABEL: Net promoter score 
## VALUES:
## -1, 0, 1, 1, 0, 1, 1, -1
## VALUE LABELS:               
##  -1 Detractors 
##   0 Neutralists
##   1 Promoters</code></pre>
<pre class="r"><code>prepend_values(nps)</code></pre>
<pre><code>## LABEL: Net promoter score 
## VALUES:
## -1, 0, 1, 1, 0, 1, 1, -1
## VALUE LABELS:                  
##  -1 -1 Detractors 
##   0 0 Neutralists 
##   1 1 Promoters   
##  99 99 Hard to say</code></pre>
<p>There is also <code>prepend_names</code> function but it can be applied only to data.frame.</p>
</div>
<div id="labels-with-base-r-and-ggplot2-functions" class="section level3">
<h3>Labels with base R and ggplot2 functions</h3>
<p>Base <code>table</code> and plotting with value labels:</p>
<pre class="r"><code>with(mtcars, table(am, vs))</code></pre>
<pre><code>##            vs
## am          V-engine Straight engine
##   Automatic       12               7
##   Manual           6               7</code></pre>
<pre class="r"><code>with(mtcars, 
     barplot(
         table(am, vs), 
         beside = TRUE, 
         legend = TRUE)
     )</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>There is a special function for variables labels support - <code>use_labels</code>. By now variables labels support available only for expression which will be evaluated inside data.frame.</p>
<pre class="r"><code># table with dimension names
use_labels(mtcars, table(am, vs)) </code></pre>
<pre><code>##             Engine
## Transmission V-engine Straight engine
##    Automatic       12               7
##    Manual           6               7</code></pre>
<pre class="r"><code># linear regression
use_labels(mtcars, lm(mpg ~ wt + hp + qsec)) %&gt;% summary</code></pre>
<pre><code>## 
## Call:
## lm(formula = `Miles/(US) gallon` ~ `Weight (1000 lbs)` + `Gross horsepower` + 
##     `1/4 mile time`)
## 
## Residuals:
## LABEL: Miles/(US) gallon 
## VALUES:
## -3.8591, -1.6418, -0.4636, 1.194, 5.6092
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         27.61053    8.41993   3.279  0.00278 ** 
## `Weight (1000 lbs)` -4.35880    0.75270  -5.791 3.22e-06 ***
## `Gross horsepower`  -0.01782    0.01498  -1.190  0.24418    
## `1/4 mile time`      0.51083    0.43922   1.163  0.25463    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.578 on 28 degrees of freedom
## Multiple R-squared:  0.8348, Adjusted R-squared:  0.8171 
## F-statistic: 47.15 on 3 and 28 DF,  p-value: 4.506e-11</code></pre>
<pre class="r"><code># boxplot with variable labels
use_labels(mtcars, boxplot(mpg ~ am))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>And, finally, <code>ggplot2</code> graphics with variables and value labels. Note that with ggplot2 version 3.2.0 and higher you need to explicitly convert labelled variables to factors in the <code>facet_grid</code> formula:</p>
<pre class="r"><code>library(ggplot2, warn.conflicts = FALSE)

use_labels(mtcars, {
    # &#39;..data&#39; is shortcut for all &#39;mtcars&#39; data.frame inside expression 
    ggplot(..data) +
        geom_point(aes(y = mpg, x = wt, color = qsec)) +
        facet_grid(factor(am) ~ factor(vs))
}) </code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="extreme-value-labels-support" class="section level3">
<h3>Extreme value labels support</h3>
<p>We have an option for extreme values lables support: <code>expss_enable_value_labels_support_extreme()</code>. With this option <code>factor</code>/<code>as.factor</code> will take into account empty levels. However, <code>unique</code> will give weird result for labelled variables: labels without values will be added to unique values. That’s why it is recommended to turn off this option immediately after usage. See examples.</p>
<p>We have label ‘Hard to say’ for which there are no values in <code>nps</code>:</p>
<pre class="r"><code>nps = c(-1, 0, 1, 1, 0, 1, 1, -1)
var_lab(nps) = &quot;Net promoter score&quot;
val_lab(nps) = num_lab(&quot;
            -1 Detractors
             0 Neutralists    
             1 Promoters
             99 Hard to say
&quot;)</code></pre>
<p>Here we disable labels support and get results without labels:</p>
<pre class="r"><code>expss_disable_value_labels_support()
table(nps) # there is no labels in the result</code></pre>
<pre><code>## nps
## -1  0  1 
##  2  2  4</code></pre>
<pre class="r"><code>unique(nps)</code></pre>
<pre><code>## [1] -1  0  1</code></pre>
<p>Results with default value labels support - three labels are here but “Hard to say” is absent.</p>
<pre class="r"><code>expss_enable_value_labels_support()
# table with labels but there are no label &quot;Hard to say&quot;
table(nps)</code></pre>
<pre><code>## nps
##  Detractors Neutralists   Promoters 
##           2           2           4</code></pre>
<pre class="r"><code>unique(nps)</code></pre>
<pre><code>## LABEL: Net promoter score 
## VALUES:
## -1, 0, 1
## VALUE LABELS:               
##  -1 Detractors 
##   0 Neutralists
##   1 Promoters  
##  99 Hard to say</code></pre>
<p>And now extreme value labels support - we see “Hard to say” with zero counts. Note the weird <code>unique</code> result.</p>
<pre class="r"><code>expss_enable_value_labels_support_extreme()
# now we see &quot;Hard to say&quot; with zero counts
table(nps) </code></pre>
<pre><code>## nps
##  Detractors Neutralists   Promoters Hard to say 
##           2           2           4           0</code></pre>
<pre class="r"><code># weird &#39;unique&#39;! There is a value 99 which is absent in &#39;nps&#39;
unique(nps) </code></pre>
<pre><code>## LABEL: Net promoter score 
## VALUES:
## -1, 0, 1, 99
## VALUE LABELS:               
##  -1 Detractors 
##   0 Neutralists
##   1 Promoters  
##  99 Hard to say</code></pre>
<p>Return immediately to defaults to avoid issues:</p>
<pre class="r"><code>expss_enable_value_labels_support()</code></pre>
</div>
<div id="labels-are-preserved-during-common-operations-on-the-data" class="section level3">
<h3>Labels are preserved during common operations on the data</h3>
<p>There are special methods for subsetting and concatenating labelled variables. These methods preserve labels during common operations. We don’t need to restore labels on subsetted or sorted data.frame.</p>
<p><code>mtcars</code> with labels:</p>
<pre class="r"><code>str(mtcars)</code></pre>
<pre><code>## &#39;data.frame&#39;:    32 obs. of  11 variables:
##  $ mpg :Class &#39;labelled&#39; num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##    .. .. LABEL: Miles/(US) gallon 
##  $ cyl :Class &#39;labelled&#39; num  6 6 4 6 8 6 8 4 4 6 ...
##    .. .. LABEL: Number of cylinders 
##  $ disp:Class &#39;labelled&#39; num  160 160 108 258 360 ...
##    .. .. LABEL: Displacement (cu.in.) 
##  $ hp  :Class &#39;labelled&#39; num  110 110 93 110 175 105 245 62 95 123 ...
##    .. .. LABEL: Gross horsepower 
##  $ drat:Class &#39;labelled&#39; num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...
##    .. .. LABEL: Rear axle ratio 
##  $ wt  :Class &#39;labelled&#39; num  2.62 2.88 2.32 3.21 3.44 ...
##    .. .. LABEL: Weight (1000 lbs) 
##  $ qsec:Class &#39;labelled&#39; num  16.5 17 18.6 19.4 17 ...
##    .. .. LABEL: 1/4 mile time 
##  $ vs  :Class &#39;labelled&#39; num  0 0 1 1 0 1 0 1 1 1 ...
##    .. .. LABEL: Engine 
##    .. .. VALUE LABELS [1:2]: 0=V-engine, 1=Straight engine 
##  $ am  :Class &#39;labelled&#39; num  1 1 1 0 0 0 0 0 0 0 ...
##    .. .. LABEL: Transmission 
##    .. .. VALUE LABELS [1:2]: 0=Automatic, 1=Manual 
##  $ gear:Class &#39;labelled&#39; num  4 4 4 3 3 3 3 4 4 4 ...
##    .. .. LABEL: Number of forward gears 
##  $ carb:Class &#39;labelled&#39; num  4 4 1 1 2 1 4 2 2 4 ...
##    .. .. LABEL: Number of carburetors</code></pre>
<p>Make subset of the data.frame:</p>
<pre class="r"><code>mtcars_subset = mtcars[1:10, ]</code></pre>
<p>Labels are here, nothing is lost:</p>
<pre class="r"><code>str(mtcars_subset)</code></pre>
<pre><code>## &#39;data.frame&#39;:    10 obs. of  11 variables:
##  $ mpg :Class &#39;labelled&#39; num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2
##    .. .. LABEL: Miles/(US) gallon 
##  $ cyl :Class &#39;labelled&#39; num  6 6 4 6 8 6 8 4 4 6
##    .. .. LABEL: Number of cylinders 
##  $ disp:Class &#39;labelled&#39; num  160 160 108 258 360 ...
##    .. .. LABEL: Displacement (cu.in.) 
##  $ hp  :Class &#39;labelled&#39; num  110 110 93 110 175 105 245 62 95 123
##    .. .. LABEL: Gross horsepower 
##  $ drat:Class &#39;labelled&#39; num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92
##    .. .. LABEL: Rear axle ratio 
##  $ wt  :Class &#39;labelled&#39; num  2.62 2.88 2.32 3.21 3.44 ...
##    .. .. LABEL: Weight (1000 lbs) 
##  $ qsec:Class &#39;labelled&#39; num  16.5 17 18.6 19.4 17 ...
##    .. .. LABEL: 1/4 mile time 
##  $ vs  :Class &#39;labelled&#39; num  0 0 1 1 0 1 0 1 1 1
##    .. .. LABEL: Engine 
##    .. .. VALUE LABELS [1:2]: 0=V-engine, 1=Straight engine 
##  $ am  :Class &#39;labelled&#39; num  1 1 1 0 0 0 0 0 0 0
##    .. .. LABEL: Transmission 
##    .. .. VALUE LABELS [1:2]: 0=Automatic, 1=Manual 
##  $ gear:Class &#39;labelled&#39; num  4 4 4 3 3 3 3 4 4 4
##    .. .. LABEL: Number of forward gears 
##  $ carb:Class &#39;labelled&#39; num  4 4 1 1 2 1 4 2 2 4
##    .. .. LABEL: Number of carburetors</code></pre>
</div>
<div id="interaction-with-haven" class="section level3">
<h3>Interaction with ‘haven’</h3>
<p>To use <code>expss</code> with <code>haven</code> you need to load <code>expss</code> strictly after <code>haven</code> (or other package with implemented ‘labelled’ class) to avoid conflicts. And it is better to use <code>read_spss</code> with explict package specification: <code>haven::read_spss</code>. See example below. <code>haven</code> package doesn’t set ‘labelled’ class for variables which have variable label but don’t have value labels. It leads to labels losing during subsetting and other operations. We have a special function to fix this: <code>add_labelled_class</code>. Apply it to dataset loaded by <code>haven</code>.</p>
<pre class="r"><code># we need to load packages strictly in this order to avoid conflicts
library(haven)
library(expss)
spss_data = haven::read_spss(&quot;spss_file.sav&quot;)
# add missing &#39;labelled&#39; class
spss_data = add_labelled_class(spss_data) </code></pre>
</div>
</div>
<div id="export-to-microsoft-excel" class="section level2">
<h2>Export to Microsoft Excel</h2>
<p>To export <code>expss</code> tables to *.xlsx you need to install excellent <code>openxlsx</code> package. To install it just type in the console <code>install.packages(&quot;openxlsx&quot;)</code>. On Windows system you may need also install RTools. It can be downloaded from CRAN: <a href="https://cran.r-project.org/bin/windows/Rtools/">RTools</a>.</p>
<p>First we apply labels on the mtcars dataset and build simple table with caption.</p>
<pre class="r"><code>library(expss)
library(openxlsx)
data(mtcars)
mtcars = apply_labels(mtcars,
                      mpg = &quot;Miles/(US) gallon&quot;,
                      cyl = &quot;Number of cylinders&quot;,
                      disp = &quot;Displacement (cu.in.)&quot;,
                      hp = &quot;Gross horsepower&quot;,
                      drat = &quot;Rear axle ratio&quot;,
                      wt = &quot;Weight (lb/1000)&quot;,
                      qsec = &quot;1/4 mile time&quot;,
                      vs = &quot;Engine&quot;,
                      vs = c(&quot;V-engine&quot; = 0,
                             &quot;Straight engine&quot; = 1),
                      am = &quot;Transmission&quot;,
                      am = c(&quot;Automatic&quot; = 0,
                             &quot;Manual&quot;=1),
                      gear = &quot;Number of forward gears&quot;,
                      carb = &quot;Number of carburetors&quot;
)

mtcars_table = mtcars %&gt;% 
    calc_cro_cpct(
        cell_vars = list(cyl, gear),
        col_vars = list(total(), am, vs)
    ) %&gt;% 
    set_caption(&quot;Table 1&quot;)

mtcars_table</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<td colspan="8" style="text-align: left;">
Table 1
</td>
</tr>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="1" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 #Total 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Transmission 
</th>
<th style="border-top: 2px solid grey;; border-bottom: hidden;">
 
</th>
<th colspan="2" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Engine 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Automatic 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Manual 
</th>
<th style="border-bottom: 1px solid grey;" colspan="1">
 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 V-engine 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 Straight engine 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="8" style="font-weight: 900;">
 Number of cylinders 
</td>
</tr>
<tr>
<td style="text-align: left;">
   4 
</td>
<td style="text-align: right;">
34.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
15.8
</td>
<td style="text-align: right;">
61.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
5.6
</td>
<td style="text-align: right;">
71.4
</td>
</tr>
<tr>
<td style="text-align: left;">
   6 
</td>
<td style="text-align: right;">
21.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.1
</td>
<td style="text-align: right;">
23.1
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
16.7
</td>
<td style="text-align: right;">
28.6
</td>
</tr>
<tr>
<td style="text-align: left;">
   8 
</td>
<td style="text-align: right;">
43.8
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
63.2
</td>
<td style="text-align: right;">
15.4
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
77.8
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   #Total cases 
</td>
<td style="text-align: right;">
32
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
19
</td>
<td style="text-align: right;">
13
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
18
</td>
<td style="text-align: right;">
14
</td>
</tr>
<tr>
<td colspan="8" style="font-weight: 900;">
 Number of forward gears 
</td>
</tr>
<tr>
<td style="text-align: left;">
   3 
</td>
<td style="text-align: right;">
46.9
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
78.9
</td>
<td style="text-align: right;">
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
66.7
</td>
<td style="text-align: right;">
21.4
</td>
</tr>
<tr>
<td style="text-align: left;">
   4 
</td>
<td style="text-align: right;">
37.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
21.1
</td>
<td style="text-align: right;">
61.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
11.1
</td>
<td style="text-align: right;">
71.4
</td>
</tr>
<tr>
<td style="text-align: left;">
   5 
</td>
<td style="text-align: right;">
15.6
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
38.5
</td>
<td style colspan="1">
 
</td>
<td style="text-align: right;">
22.2
</td>
<td style="text-align: right;">
7.1
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
32
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
19
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
13
</td>
<td style="border-bottom: 2px solid grey;" colspan="1">
 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
18
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
14
</td>
</tr>
</tbody>
</table>
<p>Then we create workbook and add worksheet to it.</p>
<pre class="r"><code>wb = createWorkbook()
sh = addWorksheet(wb, &quot;Tables&quot;)</code></pre>
<p>Export - we should specify workbook and worksheet.</p>
<pre class="r"><code>xl_write(mtcars_table, wb, sh)</code></pre>
<p>And, finally, we save workbook with table to the xlsx file.</p>
<pre class="r"><code>saveWorkbook(wb, &quot;table1.xlsx&quot;, overwrite = TRUE)</code></pre>
<p>Screenshot of the exported table: <img src="screen_xlsx1.png" alt="table1.xlsx" /></p>
<div id="automation-of-the-report-generation" class="section level3">
<h3>Automation of the report generation</h3>
<p>First of all, we create banner which we will use for all our tables.</p>
<pre class="r"><code>banner = calc(mtcars, list(total(), am, vs))</code></pre>
<p>Then we generate list with all tables. If variables have small number of discrete values we create column percent table. In other cases we calculate table with means. For both types of tables we mark significant differencies between groups.</p>
<pre class="r"><code>list_of_tables = lapply(mtcars, function(variable) {
    if(length(unique(variable))&lt;7){
        cro_cpct(variable, banner) %&gt;% significance_cpct()
    } else {
        # if number of unique values greater than seven we calculate mean
        cro_mean_sd_n(variable, banner) %&gt;% significance_means()
        
    }
    
})</code></pre>
<p>Create workbook:</p>
<pre class="r"><code>wb = createWorkbook()
sh = addWorksheet(wb, &quot;Tables&quot;)</code></pre>
<p>Here we export our list with tables with additional formatting. We remove ‘#’ sign from totals and mark total column with bold. You can read about formatting options in the manual fro <code>xl_write</code> (<code>?xl_write</code> in the console).</p>
<pre class="r"><code>xl_write(list_of_tables, wb, sh, 
         # remove &#39;#&#39; sign from totals 
         col_symbols_to_remove = &quot;#&quot;,
         row_symbols_to_remove = &quot;#&quot;,
         # format total column as bold
         other_col_labels_formats = list(&quot;#&quot; = createStyle(textDecoration = &quot;bold&quot;)),
         other_cols_formats = list(&quot;#&quot; = createStyle(textDecoration = &quot;bold&quot;)),
         )</code></pre>
<p>Save workbook:</p>
<pre class="r"><code>saveWorkbook(wb, &quot;report.xlsx&quot;, overwrite = TRUE)</code></pre>
<p>Screenshot of the generated report: <img src="screen_xlsx2.png" alt="report.xlsx" /></p>
</div>
</div>
<div id="excel-functions-translation-guide" class="section level2">
<h2>Excel functions translation guide</h2>
<p>Let us consider Excel toy table:</p>
<table style='width:30%;'>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
<th style="text-align:right;">
C
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
80
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
40
</td>
</tr>
</tbody>
</table>
<p><br> Code for creating the same table in R:</p>
<pre class="r"><code>library(expss)
w = text_to_columns(&quot;
        a  b  c
        2 15 50
        1 70 80
        3 30 40
        2 30 40
&quot;)</code></pre>
<p><code>w</code> is the name of our table.</p>
<div id="if" class="section level5">
<h5>IF</h5>
<p><strong>Excel: <code>IF(B1&gt;60, 1, 0)</code></strong></p>
<p><strong>R:</strong> Here we create new column with name <code>d</code> with results. <code>ifelse</code> function is from base R not from ‘expss’ package but included here for completeness.</p>
<pre class="r"><code>w$d = ifelse(w$b&gt;60, 1, 0)</code></pre>
<p>If we need to use multiple transformations it is often convenient to use <code>compute</code> function. Inside <code>compute</code> we can put arbitrary number of the statements:</p>
<pre class="r"><code>w = compute(w, {
    d = ifelse(b&gt;60, 1, 0)
    e = 42
    abc_sum = sum_row(a, b, c)
    abc_mean = mean_row(a, b, c)
})</code></pre>
</div>
<div id="countif" class="section level5">
<h5>COUNTIF</h5>
<p>Count 1’s in the entire dataset.</p>
<p><strong>Excel: <code>COUNTIF(A1:C4, 1)</code></strong></p>
<p><strong>R:</strong></p>
<pre class="r"><code>count_if(1, w)</code></pre>
<p>or</p>
<pre class="r"><code>calculate(w, count_if(1, a, b, c))</code></pre>
<p>Count values greater than 1 in each row of the dataset.</p>
<p><strong>Excel: <code>COUNTIF(A1:C1, &quot;&gt;1&quot;)</code></strong></p>
<p><strong>R</strong>:</p>
<pre class="r"><code>w$d = count_row_if(gt(1), w)  </code></pre>
<p>or</p>
<pre class="r"><code>w = compute(w, {
    d = count_row_if(gt(1), a, b, c) 
})</code></pre>
<p>Count values less than or equal to 1 in column A of the dataset.</p>
<p><strong>Excel: <code>COUNTIF(A1:A4, &quot;&lt;=1&quot;)</code></strong></p>
<p><strong>R</strong>:</p>
<pre class="r"><code>count_col_if(le(1), w$a)</code></pre>
Table of criteria:
<table style='width:30%;'>
<thead>
<tr>
<th style="text-align:right;">
Excel
</th>
<th style="text-align:right;">
R
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
&lt;1
</td>
<td style="text-align:right;">
lt(1)
</td>
</tr>
<tr>
<td style="text-align:right;">
&lt;=1
</td>
<td style="text-align:right;">
le(1)
</td>
</tr>
<tr>
<td style="text-align:right;">
&lt;&gt;1
</td>
<td style="text-align:right;">
ne(1)
</td>
</tr>
<tr>
<td style="text-align:right;">
=1
</td>
<td style="text-align:right;">
eq(1)
</td>
</tr>
<tr>
<td style="text-align:right;">
&gt;=1
</td>
<td style="text-align:right;">
ge(1)
</td>
</tr>
<tr>
<td style="text-align:right;">
&gt;1
</td>
<td style="text-align:right;">
gt(1)
</td>
</tr>
</tbody>
</table>
<p><br></p>
</div>
<div id="sumaverage" class="section level5">
<h5>SUM/AVERAGE</h5>
<p>Sum all values in the dataset.</p>
<p><strong>Excel: <code>SUM(A1:C4)</code></strong></p>
<p><strong>R:</strong></p>
<pre class="r"><code>sum(w, na.rm = TRUE)</code></pre>
<p>Calculate average of each row of the dataset.</p>
<p><strong>Excel: <code>AVERAGE(A1:C1)</code></strong></p>
<p><strong>R</strong>:</p>
<pre class="r"><code>w$d = mean_row(w)  </code></pre>
<p>or</p>
<pre class="r"><code>w = compute(w, {
    d = mean_row(a, b, c) 
})</code></pre>
<p>Sum values of column <code>A</code> of the dataset.</p>
<p><strong>Excel: <code>SUM(A1:A4)</code></strong></p>
<p><strong>R</strong>:</p>
<pre class="r"><code>sum_col(w$a)</code></pre>
</div>
<div id="sumifaverageif" class="section level5">
<h5>SUMIF/AVERAGEIF</h5>
<p>Sum values greater than 40 in the entire dataset.</p>
<p><strong>Excel: <code>SUMIF(A1:C4, &quot;&gt;40&quot;)</code></strong></p>
<p><strong>R:</strong></p>
<pre class="r"><code>sum_if(gt(40), w)</code></pre>
<p>or</p>
<pre class="r"><code>calculate(w, sum_if(gt(40), a, b, c))</code></pre>
<p>Sum values less than 40 in the each row of the dataset.</p>
<p><strong>Excel: <code>SUMIF(A1:C1, &quot;&lt;40&quot;)</code></strong></p>
<p><strong>R</strong>:</p>
<pre class="r"><code>w$d = sum_row_if(lt(40), w)  </code></pre>
<p>or</p>
<pre class="r"><code>w = compute(w, {
    d = sum_row_if(lt(40), a, b, c) 
})</code></pre>
<p>Calculate average of <code>B</code> column with column <code>A</code> values less than 3.</p>
<p><strong>Excel: <code>AVERAGEIF(A1:A4, &quot;&lt;3&quot;, B1:B4)</code></strong></p>
<p><strong>R</strong>:</p>
<pre class="r"><code>mean_col_if(lt(3), w$a, data = w$b)</code></pre>
<p>or, if we want calculate means for both <code>b</code> and <code>c</code> columns:</p>
<pre class="r"><code>calculate(w, mean_col_if(lt(3), a, data = sheet(b, c)))</code></pre>
</div>
<div id="vlookup" class="section level5">
<h5>VLOOKUP</h5>
Our dictionary for lookup:
<table style='width:30%;'>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
X
</th>
<th style="text-align:left;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
apples
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
oranges
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
peaches
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Code for creating the same dictionary in R:</p>
<pre class="r"><code>dict = text_to_columns(&quot;
    x  y
    1  apples
    2  oranges
    3  peaches
&quot;)</code></pre>
<p><strong>Excel: <code>VLOOKUP(A1, $X$1:$Y$3, 2, FALSE)</code></strong></p>
<p><strong>R</strong>:</p>
<pre class="r"><code>w$d = vlookup(w$a, dict, 2)</code></pre>
<p>or, we can use column names:</p>
<pre class="r"><code>w$d = vlookup(w$a, dict, &quot;y&quot;)</code></pre>
</div>
</div>
<div id="spss-functions-translation-guide" class="section level2">
<h2>SPSS functions translation guide</h2>
<div id="compute" class="section level5">
<h5>COMPUTE</h5>
<p><strong>SPSS</strong>:</p>
<pre><code>COMPUTE d = 1.</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>w$d = 1</code></pre>
<p>or, in the specific data.frame</p>
<pre class="r"><code>w = compute(w, {
    d = 1
})</code></pre>
<p>There can be arbitrary number of statements inside <code>compute</code>.</p>
</div>
<div id="if-1" class="section level5">
<h5>IF</h5>
<p><strong>SPSS</strong>:</p>
<pre><code>IF(a = 3) d = 2.</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>w = compute(w, {
    d = ifelse(a == 3, 2, NA)
})</code></pre>
<p>or,</p>
<pre class="r"><code>w = compute(w, {
    d = ifs(a == 3 ~ 2)
})</code></pre>
</div>
<div id="do-if" class="section level5">
<h5>DO IF</h5>
<p><strong>SPSS</strong>:</p>
<pre><code>DO IF (a&gt;1).
    COMPUTE d = 4.
END IF.</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>w = do_if(w, a&gt;1, {
    d = 4
})</code></pre>
<p>There can be arbitrary number of statements inside <code>do_if</code>.</p>
</div>
<div id="count" class="section level5">
<h5>COUNT</h5>
<p><strong>SPSS</strong>:</p>
<pre><code>COUNT cnt = a1 TO a5 (LO THRU HI).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>cnt = count_row_if(lo %thru% hi, a1 %to% a5)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>COUNT cnt = a1 TO a5 (SYSMIS).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>cnt = count_row_if(NA, a1 %to% a5)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>COUNT cnt = a1 TO a5 (1 THRU 5).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>cnt = count_row_if(1 %thru% 5, a1 %to% a5)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>COUNT cnt = a1 TO a5 (1 THRU HI).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>cnt = count_row_if(1 %thru% hi, a1 %to% a5)</code></pre>
<p>or,</p>
<pre class="r"><code>cnt = count_row_if(ge(1), a1 %to% a5)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>COUNT cnt = a1 TO a5 (LO THRU 1).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>cnt = count_row_if(lo %thru% 1, a1 %to% a5)</code></pre>
<p>or,</p>
<pre class="r"><code>cnt = count_row_if (le(1), a1 %to% a5)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>COUNT cnt = a1 TO a5 (1 THRU 5, 99).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>cnt = count_row_if(1 %thru% 5 | 99, a1 %to% a5)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>COUNT cnt = a1 TO a5(1,2,3,4,5, SYSMIS).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>cnt = count_row_if(c(1:5, NA), a1 %to% a5)</code></pre>
<p><code>count_row_if</code> can be used inside <code>compute</code>.</p>
</div>
<div id="recode" class="section level5">
<h5>RECODE</h5>
<p><strong>SPSS</strong>:</p>
<pre><code>RECODE V1 (0=1) (1=0) (2, 3=-1) (9=9) (ELSE=SYSMIS)</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>recode(v1) = c(0 ~ 1, 1 ~ 0, 2:3 ~ -1, 9 ~ 9, other ~ NA)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>RECODE QVAR(1 THRU 5=1)(6 THRU 10=2)(11 THRU HI=3)(ELSE=0).</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>recode(qvar) = c(1 %thru% 5 ~ 1, 6 %thru% 10 ~ 2, 11 %thru% hi ~ 3, other ~ 0)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>RECODE STRNGVAR (&#39;A&#39;, &#39;B&#39;, &#39;C&#39;=&#39;A&#39;)(&#39;D&#39;, &#39;E&#39;, &#39;F&#39;=&#39;B&#39;)(ELSE=&#39; &#39;). </code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>recode(strngvar) = c(c(&#39;A&#39;, &#39;B&#39;, &#39;C&#39;) ~ &#39;A&#39;, c(&#39;D&#39;, &#39;E&#39;, &#39;F&#39;) ~ &#39;B&#39;, other ~ &#39; &#39;)</code></pre>
<p><strong>SPSS</strong>:</p>
<pre><code>RECODE AGE (MISSING=9) (18 THRU HI=1) (0 THRU 18=0) INTO VOTER. </code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>voter = recode(age, NA ~ 9, 18 %thru% hi ~ 1, 0 %thru% 18 ~ 0)
# or
recode(age, NA ~ 9, 18 %thru% hi ~ 1, 0 %thru% 18 ~ 0) %into% voter</code></pre>
<p><code>recode</code> can be used inside <code>compute</code>.</p>
</div>
<div id="variable-labels" class="section level5">
<h5>VARIABLE LABELS</h5>
<p><strong>SPSS</strong>:</p>
<pre><code>VARIABLE LABELS a &quot;Fruits&quot;
                b &quot;Cost&quot;
                c &quot;Price&quot;.</code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>w = apply_labels(w,
                 a = &quot;Fruits&quot;,
                 b = &quot;Cost&quot;,
                 c = &quot;Price&quot;
)</code></pre>
</div>
<div id="value-labels" class="section level5">
<h5>VALUE LABELS</h5>
<p><strong>SPSS</strong>:</p>
<pre><code>VALUE LABELS a
    1 &quot;apples&quot;
    2 &quot;oranges&quot;
    3 &quot;peaches&quot;. </code></pre>
<p><strong>R</strong>:</p>
<pre class="r"><code>w = apply_labels(w, 
                 a = num_lab(&quot;
                        1 apples
                        2 oranges
                        3 peaches 
                    &quot;)
)</code></pre>
<p>or,</p>
<pre class="r"><code>val_lab(w$a) = num_lab(&quot;
    1 apples
    2 oranges
    3 peaches 
&quot;)</code></pre>
</div>
<div id="tables" class="section level5">
<h5>Tables</h5>
<p><strong>R</strong>:</p>
<pre class="r"><code>fre(w$a) # Frequency of fruits</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Fruits
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Count 
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Valid percent 
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Percent 
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Responses, % 
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Cumulative responses, % 
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
 apples 
</td>
<td style="text-align: right;">
1
</td>
<td style="text-align: right;">
25
</td>
<td style="text-align: right;">
25
</td>
<td style="text-align: right;">
25
</td>
<td style="text-align: right;">
25
</td>
</tr>
<tr>
<td style="text-align: left;">
 oranges 
</td>
<td style="text-align: right;">
2
</td>
<td style="text-align: right;">
50
</td>
<td style="text-align: right;">
50
</td>
<td style="text-align: right;">
50
</td>
<td style="text-align: right;">
75
</td>
</tr>
<tr>
<td style="text-align: left;">
 peaches 
</td>
<td style="text-align: right;">
1
</td>
<td style="text-align: right;">
25
</td>
<td style="text-align: right;">
25
</td>
<td style="text-align: right;">
25
</td>
<td style="text-align: right;">
100
</td>
</tr>
<tr>
<td style="text-align: left;">
 #Total 
</td>
<td style="text-align: right;">
4
</td>
<td style="text-align: right;">
100
</td>
<td style="text-align: right;">
100
</td>
<td style="text-align: right;">
100
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
 &lt;NA&gt; 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
0
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
0
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>cro_cpct(w$b, w$a) # Column percent of cost by fruits</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Fruits 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 apples 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 oranges 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 peaches 
</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="4" style="font-weight: 900;">
 Cost 
</td>
</tr>
<tr>
<td style="text-align: left;">
   15 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
50
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="text-align: left;">
   30 
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
50
</td>
<td style="text-align: right;">
100
</td>
</tr>
<tr>
<td style="text-align: left;">
   70 
</td>
<td style="text-align: right;">
100
</td>
<td style="text-align: right;">
</td>
<td style="text-align: right;">
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
   #Total cases 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
2
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
1
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>cro_mean(sheet(w$b, w$c), w$a) # Mean cost and price by fruits</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-top: 2px solid grey;">
</th>
<th colspan="3" style="font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
 Fruits 
</th>
</tr>
<tr>
<th style="font-weight: 900; border-bottom: 1px solid grey; text-align: center;">
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 apples 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 oranges 
</th>
<th style="border-bottom: 1px solid grey; text-align: center;">
 peaches 
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
 Cost 
</td>
<td style="text-align: right;">
70
</td>
<td style="text-align: right;">
22.5
</td>
<td style="text-align: right;">
30
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
 Price 
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
80
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
45.0
</td>
<td style="border-bottom: 2px solid grey; text-align: right;">
40
</td>
</tr>
</tbody>
</table>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
